<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Shirley Young</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="前端新手，请多指教">
<meta property="og:type" content="website">
<meta property="og:title" content="Shirley Young">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Shirley Young">
<meta property="og:description" content="前端新手，请多指教">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Shirley Young">
<meta name="twitter:description" content="前端新手，请多指教">
  
    <link rel="alternative" href="/atom.xml" title="Shirley Young" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars1.githubusercontent.com/u/29747867" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">ShirleyYoung</a></h1>
		</hgroup>

		
		<p class="header-subtitle">前端博客</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/codingShirley" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/p/1006062608078012/home" title="weibo">weibo</a>
					        
								<a class="mail" target="_blank" href="/codingshirley@gmail.com" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Accelerate/" style="font-size: 10px;">Accelerate</a> <a href="/tags/Fight/" style="font-size: 10px;">Fight</a> <a href="/tags/Injury/" style="font-size: 10px;">Injury</a> <a href="/tags/Playground/" style="font-size: 10px;">Playground</a> <a href="/tags/Shocking/" style="font-size: 10px;">Shocking</a> <a href="/tags/TouchID/" style="font-size: 10px;">TouchID</a> <a href="/tags/Universal-Links/" style="font-size: 10px;">Universal Links</a> <a href="/tags/blog-tools-ci/" style="font-size: 10px;">blog, tools, ci</a> <a href="/tags/defer/" style="font-size: 10px;">defer</a> <a href="/tags/document/" style="font-size: 10px;">document</a> <a href="/tags/guard/" style="font-size: 10px;">guard</a> <a href="/tags/hitTest/" style="font-size: 10px;">hitTest</a> <a href="/tags/javaScript/" style="font-size: 10px;">javaScript</a> <a href="/tags/lazy/" style="font-size: 10px;">lazy</a> <a href="/tags/nextResponder/" style="font-size: 10px;">nextResponder</a> <a href="/tags/phython/" style="font-size: 10px;">phython</a> <a href="/tags/responder-chain/" style="font-size: 10px;">responder chain</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/博客/" style="font-size: 10px;">博客</a> <a href="/tags/同步异步/" style="font-size: 10px;">同步异步</a> <a href="/tags/开发效率/" style="font-size: 10px;">开发效率</a> <a href="/tags/效率/" style="font-size: 10px;">效率</a> <a href="/tags/游戏/" style="font-size: 10px;">游戏</a> <a href="/tags/物理引擎/" style="font-size: 10px;">物理引擎</a> <a href="/tags/研发杂谈/" style="font-size: 10px;">研发杂谈</a> <a href="/tags/线程/" style="font-size: 10px;">线程</a> <a href="/tags/网站/" style="font-size: 10px;">网站</a> <a href="/tags/通用链接/" style="font-size: 10px;">通用链接</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://zhipingyang.github.io/">xcodeyang&#39;s blog&#39;</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">If you want to go fast, go alone. If you want to go far, go with others.</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">ShirleyYoung</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://avatars1.githubusercontent.com/u/29747867" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">ShirleyYoung</h1>
			</hgroup>
			
			<p class="header-subtitle">前端博客</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/codingShirley" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/p/1006062608078012/home" title="weibo">weibo</a>
			        
						<a class="mail" target="_blank" href="/codingshirley@gmail.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-2017-12-22" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/12/22/2017-12-22/" class="article-date">
  	<time datetime="2017-12-22T16:04:29.000Z" itemprop="datePublished">2017-12-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/12/22/2017-12-22/">第6期博客（响应链）</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="iOS响应链中HitTest、nextReponder的介绍"><a href="#iOS响应链中HitTest、nextReponder的介绍" class="headerlink" title="iOS响应链中HitTest、nextReponder的介绍"></a>iOS响应链中HitTest、nextReponder的介绍</h1><blockquote>
<p>iOS的UIEvent事件有好几种：Touch Events(触摸事件)、Motion Events(运动事件)、Remote Events(远程事件)，其中最常用的应该就是Touch Events了，今天我们主要就讲它，核心就是到<code>UIView</code>的<br><code>func hitTest(_ point: CGPoint, with event: UIEvent?) -&gt; UIView?</code><br>以及nextReponder两个</p>
</blockquote>
<p><strong>比如成果：魔图&amp;图片浏览 复杂的视图层级拆分</strong></p>
<p><img src="https://user-images.githubusercontent.com/9360037/34282300-3e5aab32-e6ff-11e7-87f3-4b9f4a1d5692.png" alt="wechatimg166"><br><img src="https://user-images.githubusercontent.com/9360037/34268452-b59c6ae4-e6bb-11e7-974e-63411e9f87b3.png" alt="pb"></p>
<p><strong>考一考:</strong> 直接继承于UIResponder的类有哪些？</p>
<h2 id="UIResponder-响应链-？？"><a href="#UIResponder-响应链-？？" class="headerlink" title="UIResponder ?? 响应链 ？？"></a>UIResponder ?? 响应链 ？？</h2><ul>
<li>响应链是什么时候怎样构建的？</li>
<li>事件第一个响应者是怎么确定的？</li>
<li>事件第一个响应者确定后，系统是怎样传递事件的？</li>
</ul>
<h3 id="响应链的构建"><a href="#响应链的构建" class="headerlink" title="响应链的构建"></a>响应链的构建</h3><p>先看看UIResponder类</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">open <span class="keyword">var</span> next: <span class="type">UIResponder</span>? &#123; <span class="keyword">get</span> &#125;</div><div class="line">open <span class="keyword">var</span> canBecomeFirstResponder: <span class="type">Bool</span> &#123; <span class="keyword">get</span> &#125; <span class="comment">// default is NO    </span></div><div class="line"><span class="comment">// default is NO</span></div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">becomeFirstResponder</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span></div><div class="line">open <span class="keyword">var</span> canResignFirstResponder: <span class="type">Bool</span> &#123; <span class="keyword">get</span> &#125; <span class="comment">// default is YES    </span></div><div class="line"><span class="comment">// default is YES</span></div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">resignFirstResponder</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span></div><div class="line">open <span class="keyword">var</span> isFirstResponder: <span class="type">Bool</span> &#123; <span class="keyword">get</span> &#125;</div><div class="line"></div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">touchesBegan</span><span class="params">(<span class="number">_</span> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span></div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">touchesMoved</span><span class="params">(<span class="number">_</span> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span></div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">touchesEnded</span><span class="params">(<span class="number">_</span> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span></div><div class="line">open <span class="function"><span class="keyword">func</span> <span class="title">touchesCancelled</span><span class="params">(<span class="number">_</span> touches: Set&lt;UITouch&gt;, with event: UIEvent?)</span></span></div></pre></td></tr></table></figure>
<p>常见的触摸响应链构建</p>
<blockquote>
<ol>
<li>addSubview</li>
<li>ViewController 初始化</li>
</ol>
</blockquote>
<p><img src="https://user-images.githubusercontent.com/9360037/34268459-b9c32874-e6bb-11e7-8227-ae124123a837.png" alt="res"></p>
<h4 id="事件响应过程"><a href="#事件响应过程" class="headerlink" title="事件响应过程"></a>事件响应过程</h4><ul>
<li>触摸开始</li>
<li>事件入栈</li>
<li>runloop响应</li>
<li>uiapplication 事件传递给 windows</li>
<li>hitTest 找到 view (<a href="https://lists.apple.com/archives/cocoa-dev/2014/Feb/msg00118.html" target="_blank" rel="external">hitTest会被调用两次,为什么，不知道？</a>)</li>
<li>hitView 响应 touchEvent</li>
</ul>
<p><strong>核心的方法</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">hitTest</span><span class="params">(<span class="number">_</span> point: CGPoint, with event: UIEvent?)</span></span> -&gt; <span class="type">UIView</span>?</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">point</span><span class="params">(inside point: CGPoint, with event: UIEvent?)</span></span> -&gt; <span class="type">Bool</span></div></pre></td></tr></table></figure>
<blockquote>
<p>注意：hittest &amp; pointinside是uiview的实例方法</p>
</blockquote>
<p>比如tableview的cell点击,hitTest寻找响应cell的过程</p>
<ul>
<li>windows</li>
<li>windows.rootController (navController).view</li>
<li>navController.rootControler (vc).view</li>
<li>tableview</li>
<li>some cell</li>
<li>contentView</li>
</ul>
<blockquote>
<p>Note: 查询过程也不是这么顺利的，有弯路，也有属性限制</p>
</blockquote>
<ul>
<li>hittest打算从后往前遍历subviews,直到找到才停止遍历</li>
<li>subview必须符合<ul>
<li>pointInside return YES</li>
<li>属性限制有<ul>
<li>alpha &gt; 0.01</li>
<li>hidden == NO</li>
<li>userInteractionEnabled == YES</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 模拟原生未干预下的代码</span></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">hitTest</span><span class="params">(<span class="number">_</span> point: CGPoint, with event: UIEvent?)</span></span> -&gt; <span class="type">UIView</span>? &#123;</div><div class="line">	<span class="keyword">if</span> !isUserInteractionEnabled || isHidden || alpha&lt;=<span class="number">0.01</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</div><div class="line">	<span class="keyword">if</span> !<span class="keyword">self</span>.point(inside: point, with: event) &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</div><div class="line">	<span class="keyword">for</span> subview <span class="keyword">in</span> subviews.reversed() &#123;</div><div class="line">		<span class="keyword">let</span> convertPoint = subview.convert(point, from: <span class="keyword">self</span>)</div><div class="line">		<span class="keyword">let</span> subHitTestView = subview.hitTest(convertPoint, with: event)</div><div class="line">		<span class="keyword">if</span> <span class="keyword">let</span> hitTestView = subHitTestView &#123; <span class="keyword">return</span> hitTestView &#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">self</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="那我们干预后，HitTest的实战应用就有"><a href="#那我们干预后，HitTest的实战应用就有" class="headerlink" title="那我们干预后，HitTest的实战应用就有"></a>那我们干预后，HitTest的实战应用就有</h4><ul>
<li>复杂的视图层级的拆分</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">hitTest</span><span class="params">(<span class="number">_</span> point: CGPoint, with event: UIEvent?)</span></span> -&gt; <span class="type">UIView</span>? &#123;</div><div class="line">	<span class="keyword">let</span> view = <span class="keyword">super</span>.hitTest(point, with: event)</div><div class="line">	<span class="keyword">return</span> view == <span class="keyword">self</span> ? <span class="literal">nil</span> : view</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>自定义Touch事件传递对象</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">hitTest</span><span class="params">(<span class="number">_</span> point: CGPoint, with event: UIEvent?)</span></span> -&gt; <span class="type">UIView</span>? &#123;</div><div class="line">	<span class="keyword">let</span> view = <span class="keyword">super</span>.hitTest(point, with: event)</div><div class="line">	<span class="keyword">return</span> view == someBtn ? anotherBtn : view</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>自定义控件的响应区域及响应层级</li>
</ul>
<blockquote>
<p>view修改响应区域方式有两种，一种如下，它的superview来hitTest，第二种自己hitTest</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">hitTest</span><span class="params">(<span class="number">_</span> point: CGPoint, with event: UIEvent?)</span></span> -&gt; <span class="type">UIView</span>? &#123;</div><div class="line">	<span class="keyword">if</span> someBtn.frame.insetBy(dx: -<span class="number">10</span>, dy: -<span class="number">10</span>).<span class="built_in">contains</span>(point) &#123;</div><div class="line">		<span class="keyword">return</span> someBtn</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">super</span>.point(inside: point, with: event)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="响应链-nextResponder"><a href="#响应链-nextResponder" class="headerlink" title="响应链 .nextResponder"></a>响应链 .nextResponder</h2><blockquote>
<p>和 hitTest自底向上相反，它是从最末端的responder向下传递，hitTest自下而上查找响应的view，nextResponder是基于hitTest基础上，自上而下寻找event的响应者</p>
</blockquote>
<p>常见的应用案例：BPUIResponderAdditions中的方法，可以查找view的Controller或navigationController</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">nullable</span> __kindof <span class="built_in">UIResponder</span> *)findNextResonderInClass:(<span class="keyword">nonnull</span> Class)responderClass</div><div class="line">&#123;</div><div class="line">	<span class="built_in">UIResponder</span> *next = <span class="keyword">self</span>;</div><div class="line">	<span class="keyword">do</span> &#123;</div><div class="line">		next = [next nextResponder];</div><div class="line">		<span class="keyword">if</span> ([next isKindOfClass:responderClass]) &#123;</div><div class="line">		<span class="keyword">break</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// next 不为空 且 不是达到最底层的 appdelegate</span></div><div class="line">	&#125; <span class="keyword">while</span> (next!=<span class="literal">nil</span> &amp;&amp; ![next conformsToProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">UIApplicationDelegate</span>)]);</span></div><div class="line">	<span class="keyword">return</span> next;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 查询响应最近的 controller</span></div><div class="line"><span class="built_in">UIViewController</span> *vc = [view findNextResonderInClass:[<span class="built_in">UIViewController</span> <span class="keyword">class</span>]];</div></pre></td></tr></table></figure>
<h4 id="知识点："><a href="#知识点：" class="headerlink" title="知识点："></a>知识点：</h4><ul>
<li><strong>响应链事件传递</strong></li>
</ul>
<blockquote>
<p>通过nextResponder向下传递event</p>
</blockquote>
<p>演示</p>
<blockquote>
<p>touchesBegan / super.touchesBegan 或 nextResponder.touchesBegan 一直调用下去</p>
</blockquote>
<ul>
<li><strong>第一响应者</strong><blockquote>
<p>有拦腰截断的意思，原有的顶部第一响应者被修改，响应链中接收事件第一人（常见textField，webView及UImenuController，见demo）</p>
</blockquote>
</li>
</ul>
<p>演示</p>
<blockquote>
<ul>
<li>Button event 先下传递</li>
<li>becomeFirstResponder后，nextResponder无事件下传</li>
<li>canBecomeFirstResponder \ becomeFirstResponder 拦截</li>
</ul>
</blockquote>
<ul>
<li><strong>cancelsTouchesInView</strong></li>
</ul>
<blockquote>
<p>系统会将Touch cancel消息发送给hitTestView ，并调用hitTestView的TouchCancel</p>
</blockquote>
<p>演示</p>
<blockquote>
<p>demo:button的touchUpInside对UIPanGestureRecognizer的影响</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hitTest/">hitTest</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nextResponder/">nextResponder</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/responder-chain/">responder chain</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/share/">share</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-2016-07-29" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/29/2016-07-29/" class="article-date">
  	<time datetime="2016-07-29T14:30:00.000Z" itemprop="datePublished">2016-07-29</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/29/2016-07-29/">通用链接（ Universal Links ）</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<ul>
<li>通过唯一的网址, 就可以链接一个特定的视图到你的 APP 里面, 不需要特别的 schema</li>
<li>不再需要JavaScript检查平台，跳转也不需要js去做特定处理</li>
<li>比scheme更灵活更安全的匹配URL跳转</li>
<li>实现App与Web一体化</li>
</ul>
<p>注意：不能使用模拟器调试</p>
</blockquote>
<p><img src="https://s3-eu-west-1.amazonaws.com/hoko-blog/universal_links.png" alt="image"></p>
<blockquote>
<p>工作原理：When the app is installed, the system downloads and verifies the site association file for each of its associated domains. If the verification is successful, the app is associated with the domain.</p>
</blockquote>
<p><strong>Configure your file server</strong></p>
<ul>
<li><p><a href="https://api-pre.51offer.com/apple-app-site-association" target="_blank" rel="external">我们的根路径配置文件</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  &quot;applinks&quot;: &#123;</div><div class="line">		&quot;apps&quot;:[],</div><div class="line">    &quot;details&quot;: [</div><div class="line">      &#123;</div><div class="line">        &quot;appID&quot;: &quot;E8AR4L3B2P.com.horizon.offer&quot;,</div><div class="line">        &quot;paths&quot;:[ &quot;/path/*&quot; ]</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><a href="https://branch.io/resources/universal-links/" target="_blank" rel="external">根路径配置有效性验证</a></p>
</li>
</ul>
<h5 id="要求如下："><a href="#要求如下：" class="headerlink" title="要求如下："></a>要求如下：</h5><blockquote>
<p>Alright! So you have your signed apple-app-site-association file. Now you just need to configure your file server to host this for you. There are a few caveats:</p>
<ul>
<li>It must be sent with the header ‘application/pkcs7-mime’</li>
<li>It must be sent from the endpoint youdomain.com/apple-app-site-association</li>
<li>It must return a 200 http code.</li>
</ul>
<p>We set up the one for all Branch integrated apps using our Node+Express link servers. Here’s the code we used in case that’s helpful:</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> aasa = fs.readFileSync(__dirname + <span class="string">'/static/apple-app-site-association'</span>);</div><div class="line">app.get(<span class="string">'/apple-app-site-association'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">     res.set(<span class="string">'Content-Type'</span>, <span class="string">'application/pkcs7-mime'</span>);</div><div class="line">     res.status(<span class="number">200</span>).send(aasa);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>可以从原有的scheme过渡过来<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application openURL:(<span class="built_in">NSURL</span> *)url sourceApplication:(<span class="built_in">NSString</span> *)sourceApplication annotation:(<span class="keyword">id</span>)annotation &#123;</div><div class="line">    [<span class="keyword">self</span> handleRouting:url];</div><div class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application continueUserActivity:(<span class="built_in">NSUserActivity</span> *)userActivity restorationHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSArray</span> *))restorationHandler &#123;</div><div class="line">    <span class="keyword">if</span> ([userActivity.activityType isEqualToString:<span class="built_in">NSUserActivityTypeBrowsingWeb</span>]) &#123;</div><div class="line">        [<span class="keyword">self</span> handleRouting:userActivity.webpageURL];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)handleRouting:(<span class="built_in">NSURL</span> *)url &#123;</div><div class="line">....</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>视频</strong>优先推荐<br><a href="https://developer.apple.com/videos/play/wwdc2015/509/" target="_blank" rel="external">https://developer.apple.com/videos/play/wwdc2015/509/</a></p>
<p><strong>优秀博客</strong><br><a href="https://blog.branch.io/how-to-setup-universal-links-to-deep-link-on-apple-ios-9" target="_blank" rel="external">https://blog.branch.io/how-to-setup-universal-links-to-deep-link-on-apple-ios-9</a></p>
<p><a href="https://blog.branch.io/ios-9.2-deep-linking-guide-transitioning-to-universal-links" target="_blank" rel="external">https://blog.branch.io/ios-9.2-deep-linking-guide-transitioning-to-universal-links</a></p>
<p><a href="http://blog.hokolinks.com/how-to-implement-apple-universal-links-on-ios-9/" target="_blank" rel="external">http://blog.hokolinks.com/how-to-implement-apple-universal-links-on-ios-9/</a></p>
<p><strong>可能出现的bug</strong>（巨坑，也可能是配置问题）<br><a href="http://stackoverflow.com/questions/32751225/ios9-universal-links-does-not-work" target="_blank" rel="external">http://stackoverflow.com/questions/32751225/ios9-universal-links-does-not-work</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Universal-Links/">Universal Links</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/通用链接/">通用链接</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动组周技术分享/">移动组周技术分享</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-2016-07-22" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/07/22/2016-07-22/" class="article-date">
  	<time datetime="2016-07-22T14:45:00.000Z" itemprop="datePublished">2016-07-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/22/2016-07-22/">移动周分享-第60期</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="加速库在数学运算中的使用"><a href="#加速库在数学运算中的使用" class="headerlink" title="加速库在数学运算中的使用"></a>加速库在数学运算中的使用</h2><blockquote>
<p>除了加减乘除外还有好多好多数学运算需要我们处理，但我们很多都没有用到，感觉low爆了</p>
</blockquote>
<h3 id="Apple：加速框架文档"><a href="#Apple：加速框架文档" class="headerlink" title="Apple：加速框架文档"></a><a href="https://developer.apple.com/library/ios/documentation/Accelerate/Reference/vDSPRef/index.html#//apple_ref/doc/uid/TP40009464-CH13-12342" target="_blank" rel="external">Apple：加速框架文档</a></h3><blockquote>
<p>Any time you’ve got to make some numbers happen, it’s probably worth it to consider using Accelerate</p>
</blockquote>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 模拟随机数据</span></div><div class="line"><span class="keyword">var</span> doubles  = (<span class="number">0</span>...<span class="number">10000</span>).<span class="built_in">map</span> &#123;<span class="number">_</span> <span class="keyword">in</span> <span class="type">Double</span>(arc4random()%<span class="number">10000</span>)&#125;</div><div class="line"></div><div class="line"><span class="comment">// 求和</span></div><div class="line"><span class="comment">// 常见的加法求和</span></div><div class="line"><span class="keyword">let</span> reduceSum = doubles.<span class="built_in">reduce</span>(<span class="number">0</span>) &#123; $<span class="number">0</span>+$<span class="number">1</span> &#125;</div><div class="line"><span class="comment">// Accelerate 封装</span></div><div class="line"><span class="keyword">let</span> accSum = sum(doubles)</div><div class="line"></div><div class="line"><span class="comment">// 求最大值（最小值也一样）</span></div><div class="line"><span class="keyword">let</span> maxOfArr = <span class="built_in">max</span>(doubles)</div><div class="line"><span class="keyword">let</span> maxOfArr2 = doubles.<span class="built_in">maxElement</span></div><div class="line"><span class="comment">// let maxOfArr2 = doubles.sort(&gt;).first</span></div><div class="line"></div><div class="line"><span class="comment">// 平均值,哈哈大数据统计，可以测试准确率</span></div><div class="line"><span class="keyword">let</span> meanValue = mean(doubles)</div><div class="line"><span class="keyword">let</span> meanValue2 = doubles.<span class="built_in">reduce</span>(<span class="number">0</span>) &#123; $<span class="number">0</span> + $<span class="number">1</span>/<span class="type">Double</span>(doubles.<span class="built_in">count</span>) &#125;</div><div class="line">meanValue2</div><div class="line"></div><div class="line"><span class="comment">// 向量加减乘积</span></div><div class="line"><span class="keyword">let</span> vector1 = [<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>] <span class="keyword">as</span> [<span class="type">Double</span>]</div><div class="line"><span class="keyword">let</span> vector2 = [<span class="number">3</span>,<span class="number">5</span>,<span class="number">2</span>] <span class="keyword">as</span> [<span class="type">Double</span>]</div><div class="line"><span class="keyword">let</span> sumArrs = add(vector1, y: vector2)</div></pre></td></tr></table></figure>
<p>耗时上对比是不是<code>reduce，map</code>等系统的高阶函数被<code>“加速库”</code>秒了，但使用上貌似reduce，map是比较灵活的<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> newReduceSum = (<span class="number">0</span>...<span class="number">1000</span>).<span class="built_in">reduce</span>(<span class="number">0</span>) &#123; $<span class="number">0</span>+$<span class="number">1</span> &#125;</div><div class="line">newReduceSum</div></pre></td></tr></table></figure></p>
<h3 id="其他计算的一点的应用"><a href="#其他计算的一点的应用" class="headerlink" title="其他计算的一点的应用"></a>其他计算的一点的应用</h3><blockquote>
<p>函数混合示例: 使用中文变量😄</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> 函数点阵密度 = <span class="number">64</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> 频率<span class="number">1</span> = <span class="number">4.0</span></div><div class="line"><span class="keyword">let</span> 相位<span class="number">1</span> = <span class="number">0.0</span></div><div class="line"><span class="keyword">let</span> 幅度<span class="number">1</span> = <span class="number">1.0</span></div><div class="line"><span class="keyword">let</span> 正弦函数<span class="number">1</span> = (<span class="number">0</span>..&lt;函数点阵密度).<span class="built_in">map</span> &#123;</div><div class="line">    幅度<span class="number">1</span> * sin(<span class="number">2.0</span> * <span class="type">M_PI</span> / <span class="type">Double</span>(函数点阵密度) * <span class="type">Double</span>($<span class="number">0</span>) * 频率<span class="number">1</span> + 相位<span class="number">1</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> 频率<span class="number">2</span> = <span class="number">1.0</span></div><div class="line"><span class="keyword">let</span> 相位<span class="number">2</span> = <span class="type">M_PI</span> / <span class="number">2.0</span></div><div class="line"><span class="keyword">let</span> 幅度<span class="number">2</span> = <span class="number">2.0</span></div><div class="line"><span class="keyword">let</span> 正弦函数<span class="number">2</span> = (<span class="number">0</span>..&lt;函数点阵密度).<span class="built_in">map</span> &#123;</div><div class="line">    幅度<span class="number">2</span> * sin(<span class="number">2.0</span> * <span class="type">M_PI</span> / <span class="type">Double</span>(函数点阵密度) * <span class="type">Double</span>($<span class="number">0</span>) * 频率<span class="number">2</span> + 相位<span class="number">2</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> 频率<span class="number">3</span> = <span class="number">10.0</span></div><div class="line"><span class="keyword">let</span> 相位<span class="number">3</span> = <span class="type">M_PI</span> / <span class="number">3.0</span></div><div class="line"><span class="keyword">let</span> 幅度<span class="number">3</span> = <span class="number">4.0</span></div><div class="line"><span class="keyword">let</span> 正弦函数<span class="number">3</span> = (<span class="number">0</span>..&lt;函数点阵密度).<span class="built_in">map</span> &#123;</div><div class="line">    幅度<span class="number">3</span> * sin(<span class="number">2.0</span> * <span class="type">M_PI</span> / <span class="type">Double</span>(函数点阵密度) * <span class="type">Double</span>($<span class="number">0</span>) * 频率<span class="number">3</span> + 相位<span class="number">3</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> 新函数<span class="number">1</span> = add(正弦函数<span class="number">1</span>, y: 正弦函数<span class="number">2</span>)</div><div class="line"><span class="keyword">let</span> 新函数<span class="number">2</span> = add(新函数<span class="number">1</span>, y: 正弦函数<span class="number">3</span>)</div><div class="line"></div><div class="line"><span class="comment">// Xcode 分栏查看图形排布，尤其是新函数的图形</span></div><div class="line">新函数<span class="number">1</span>.forEach &#123; <span class="type">XCPlaygroundPage</span>.currentPage.captureValue($<span class="number">0</span>, withIdentifier:<span class="string">"新函数1"</span>) &#125;</div><div class="line">新函数<span class="number">2</span>.forEach &#123; <span class="type">XCPlaygroundPage</span>.currentPage.captureValue($<span class="number">0</span>, withIdentifier:<span class="string">"新函数2"</span>) &#125;</div><div class="line"></div><div class="line">正弦函数<span class="number">2</span>.forEach &#123; <span class="type">XCPlaygroundPage</span>.currentPage.captureValue($<span class="number">0</span>, withIdentifier:<span class="string">"正弦函数2"</span>) &#125;</div><div class="line"></div><div class="line">正弦函数<span class="number">1</span>.forEach &#123; <span class="type">XCPlaygroundPage</span>.currentPage.captureValue($<span class="number">0</span>, withIdentifier:<span class="string">"正弦函数1"</span>) &#125;</div></pre></td></tr></table></figure>
<h4 id="傅里叶变换通俗篇讲解"><a href="#傅里叶变换通俗篇讲解" class="headerlink" title="傅里叶变换通俗篇讲解"></a>傅里叶变换通俗篇<a href="https://www.douban.com/note/164400821" target="_blank" rel="external">讲解</a></h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 查看图像发现‘新函数2’左右有三对波峰，得出它由三个正弦波组成（可对应得出振幅、频率及相位）</span></div><div class="line"><span class="keyword">let</span> 快速傅里叶转换 = fft(新函数<span class="number">2</span>)</div><div class="line">快速傅里叶转换.forEach &#123; <span class="type">XCPlaygroundPage</span>.currentPage.captureValue($<span class="number">0</span>, withIdentifier:<span class="string">"快速傅里叶转换"</span>) &#125;</div></pre></td></tr></table></figure>
<h3 id="矩阵计算"><a href="#矩阵计算" class="headerlink" title="矩阵计算"></a>矩阵计算</h3><blockquote>
<p>很多图像处理是根据矩阵做处理的，像素越大，处理性能要求越高</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 简单矩阵示例</span></div><div class="line"></div><div class="line"><span class="comment">// ⎛ 1  2 ⎞      ⎛ 3  2 ⎞       ⎛ 5  6 ⎞</span></div><div class="line"><span class="comment">// ⎢      ⎟  *   ⎢      ⎟   =   ⎢      ⎟</span></div><div class="line"><span class="comment">// ⎝ 3 -4 ⎠      ⎝ 1  2 ⎠       ⎝ 5 -2 ⎠</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> <span class="type">A</span> = <span class="type">Matrix</span>([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, -<span class="number">4</span>]])</div><div class="line"><span class="keyword">let</span> <span class="type">B</span> = <span class="type">Matrix</span>([[<span class="number">3</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>]])</div><div class="line"><span class="keyword">let</span> <span class="type">C</span> = <span class="type">A</span> * <span class="type">B</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 利用逆矩阵求解</span></div><div class="line"><span class="comment">// ⎛ 1  1 ⎞        ⎛ 3 ⎞           ⎛ 2 ⎞</span></div><div class="line"><span class="comment">// ⎢      ⎟ * CC = ⎢   ⎟    CC =   ⎢   ⎟</span></div><div class="line"><span class="comment">// ⎝ 1 -1 ⎠        ⎝ 1 ⎠           ⎝ 1 ⎠</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> <span class="type">AA</span> = <span class="type">Matrix</span>([[<span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, -<span class="number">1</span>]])</div><div class="line"><span class="keyword">let</span> <span class="type">BB</span> = <span class="type">Matrix</span>([[<span class="number">3</span>], [<span class="number">1</span>]])</div><div class="line"><span class="keyword">let</span> <span class="type">CC</span> = inv(<span class="type">AA</span>) * <span class="type">BB</span></div></pre></td></tr></table></figure>
<h3 id="应用的加速库函数"><a href="#应用的加速库函数" class="headerlink" title="应用的加速库函数"></a>应用的加速库函数</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Accelerate</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(x: [Double])</span></span> -&gt; <span class="type">Double</span> &#123;</div><div class="line">    <span class="keyword">var</span> result: <span class="type">Double</span> = <span class="number">0.0</span></div><div class="line">    vDSP_sveD(x, <span class="number">1</span>, &amp;result, vDSP_Length(x.<span class="built_in">count</span>))</div><div class="line"></div><div class="line">    <span class="keyword">return</span> result</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">max</span><span class="params">(x: [Double])</span></span> -&gt; <span class="type">Double</span> &#123;</div><div class="line">    <span class="keyword">var</span> result: <span class="type">Double</span> = <span class="number">0.0</span></div><div class="line">    vDSP_maxvD(x, <span class="number">1</span>, &amp;result, vDSP_Length(x.<span class="built_in">count</span>))</div><div class="line"></div><div class="line">    <span class="keyword">return</span> result</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">mean</span><span class="params">(x: [Double])</span></span> -&gt; <span class="type">Double</span> &#123;</div><div class="line">    <span class="keyword">var</span> result: <span class="type">Double</span> = <span class="number">0.0</span></div><div class="line">    vDSP_meanvD(x, <span class="number">1</span>, &amp;result, vDSP_Length(x.<span class="built_in">count</span>))</div><div class="line"></div><div class="line">    <span class="keyword">return</span> result</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(x: [Double], y: [Double])</span></span> -&gt; [<span class="type">Double</span>] &#123;</div><div class="line">    <span class="keyword">var</span> results = [<span class="type">Double</span>](y)</div><div class="line">    cblas_daxpy(<span class="type">Int32</span>(x.<span class="built_in">count</span>), <span class="number">1.0</span>, x, <span class="number">1</span>, &amp;results, <span class="number">1</span>)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> results</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">fft</span><span class="params">(input: [Double])</span></span> -&gt; [<span class="type">Double</span>] &#123;</div><div class="line">    <span class="keyword">var</span> real = [<span class="type">Double</span>](input)</div><div class="line">    <span class="keyword">var</span> imaginary = [<span class="type">Double</span>](<span class="built_in">count</span>: input.<span class="built_in">count</span>, repeatedValue: <span class="number">0.0</span>)</div><div class="line">    <span class="keyword">var</span> splitComplex = <span class="type">DSPDoubleSplitComplex</span>(realp: &amp;real, imagp: &amp;imaginary)</div><div class="line"></div><div class="line">    <span class="keyword">let</span> length = vDSP_Length(floor(log2(<span class="type">Float</span>(input.<span class="built_in">count</span>))))</div><div class="line">    <span class="keyword">let</span> radix = <span class="type">FFTRadix</span>(kFFTRadix2)</div><div class="line">    <span class="keyword">let</span> weights = vDSP_create_fftsetupD(length, radix)</div><div class="line">    vDSP_fft_zipD(weights, &amp;splitComplex, <span class="number">1</span>, length, <span class="type">FFTDirection</span>(<span class="type">FFT_FORWARD</span>))</div><div class="line"></div><div class="line">    <span class="keyword">var</span> magnitudes = [<span class="type">Double</span>](<span class="built_in">count</span>: input.<span class="built_in">count</span>, repeatedValue: <span class="number">0.0</span>)</div><div class="line">    vDSP_zvmagsD(&amp;splitComplex, <span class="number">1</span>, &amp;magnitudes, <span class="number">1</span>, vDSP_Length(input.<span class="built_in">count</span>))</div><div class="line"></div><div class="line">    <span class="keyword">var</span> normalizedMagnitudes = [<span class="type">Double</span>](<span class="built_in">count</span>: input.<span class="built_in">count</span>, repeatedValue: <span class="number">0.0</span>)</div><div class="line">    vDSP_vsmulD(sqrt(magnitudes), <span class="number">1</span>, [<span class="number">2.0</span> / <span class="type">Double</span>(input.<span class="built_in">count</span>)], &amp;normalizedMagnitudes, <span class="number">1</span>, vDSP_Length(input.<span class="built_in">count</span>))</div><div class="line"></div><div class="line">    vDSP_destroy_fftsetupD(weights)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> normalizedMagnitudes</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Accelerate/">Accelerate</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动组周技术分享/">移动组周技术分享</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-2016-06-17" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/17/2016-06-17/" class="article-date">
  	<time datetime="2016-06-17T10:30:00.000Z" itemprop="datePublished">2016-06-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/17/2016-06-17/">Xcode MarkDown的代码文档 ( for swift )</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="markdown在swift中的应用"><a href="#markdown在swift中的应用" class="headerlink" title="markdown在swift中的应用"></a>markdown在swift中的应用</h3><h4 id="goals"><a href="#goals" class="headerlink" title="goals"></a>goals</h4><ul>
<li>描述各个属性、函数和类的真正用途</li>
<li>高亮函数的输入和输出（参数和返回值）</li>
<li>几个月后还能清晰地记得每个函数属性是为了什么</li>
<li>使用工具制作具有专业外观的使用手册（比如：使用 <a href="https://github.com/realm/jazzy" target="_blank" rel="external">Jazzy</a>）</li>
<li>Xcode 里写的代码文档能被预览</li>
</ul>
<h4 id="markdown-grammar"><a href="#markdown-grammar" class="headerlink" title="markdown grammar"></a>markdown grammar</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">#text#：文本标题</div><div class="line"></div><div class="line">**text**：使文本具有加粗的效果</div><div class="line"></div><div class="line">*text*：使文本具有斜体的效果</div><div class="line"></div><div class="line">* text：使文本成为一个无序列表的元素，值得注意的是，有个 * 后面需要有一个空格。同样，可以使用 + 或 - 实现这个的功能</div><div class="line"></div><div class="line">1.text：使文本成为一个有序列表的元素</div><div class="line"></div><div class="line">[linked text](http://some-url.com)：使文本成为可以点击的超链接</div><div class="line"></div><div class="line">![image show](http://www.appcoda.com/wp-content/uploads/2016/05/t52_3_help_inspector1.png)：可以显示图片</div><div class="line"></div><div class="line">&gt; text：创建一个块引用。</div><div class="line"></div><div class="line">使用 4 个空格或 1 个 tab 来缩进所写的代码块，等价于 HTML 中的 \\ 标签。可以继续使用 4 个空格或 1 个 tab 来添加另一个缩进</div><div class="line"></div><div class="line">如果不想使用空格或 tab 的话，可以使用 ` 。比如， `var myProperty` 会显示成 var myProperty</div><div class="line"></div><div class="line">另一种创建代码块的方法是添加 4 个 `，并从下一行开始写具体的代码，最后添加 4 个 ` 表示结束</div><div class="line"></div><div class="line">反斜杠修饰 Markdown 的特殊字符就可以避免 Markdown 语法的解析了。比如， \**this\** 就不会产生加粗的效果</div></pre></td></tr></table></figure>
<p>注释区域： 3 个斜线（///）或以下面的形式开头：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"></div><div class="line">*/</div></pre></td></tr></table></figure>
<h5 id="Case"><a href="#Case" class="headerlink" title="Case"></a>Case</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">    It calculates and returns the outcome of the division of the two parameters.</div><div class="line"></div><div class="line">    ## Important Notes ##</div><div class="line">    1. Both parameters are **double** numbers.</div><div class="line">    2. For a proper result the second parameter *must be other than 0*.</div><div class="line">    3. If the second parameter is 0 then the function will return nil.</div><div class="line"></div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">performDivision</span>（<span class="title">number1</span>: <span class="title">Double</span>, <span class="title">number2</span>: <span class="title">Double</span>） -&gt; <span class="title">Double</span>! </span>&#123;</div><div class="line">    <span class="keyword">if</span> number2 != <span class="number">0</span> &#123;</div><div class="line">        <span class="keyword">return</span> number1 / number2</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/05/t52_2_quickhelp2.png" alt="case image"></p>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/05/t52_3_help_inspector1.png" alt="quick look"></p>
<h4 id="关键词"><a href="#关键词" class="headerlink" title="关键词"></a>关键词</h4><ul>
<li>Parameter</li>
<li>Returns</li>
<li>Remark</li>
<li>SeeAlso</li>
<li>Precondiction</li>
<li>Requires</li>
<li>Todo</li>
<li>Version</li>
<li>Author</li>
<li>Note</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">    Another complicated function.</div><div class="line"></div><div class="line">    - Parameter fullname: The fullname that will be broken into its parts.</div><div class="line">    - Returns: A *tuple* with the first and last name.</div><div class="line"></div><div class="line">    - Remark:</div><div class="line">        There's a counterpart function that concatenates the first and last name into a full name.</div><div class="line"></div><div class="line">    - SeeAlso:  `createFullName（_:lastname:）`</div><div class="line"></div><div class="line">    - Precondition: `fullname` should not be nil.</div><div class="line">    - Requires: Both first and last name should be parts of the full name, separated with a *space character*.</div><div class="line"></div><div class="line">    - Todo: Support middle name in the next version.</div><div class="line"></div><div class="line">    - Warning: A wonderful **crash** will be the result of a `nil` argument.</div><div class="line"></div><div class="line">    - Version: 1.1</div><div class="line"></div><div class="line">    - Author: Myself Only</div><div class="line"></div><div class="line">    - Note: Too much documentation for such a small function.</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">breakFullName</span>（<span class="title">fullname</span>: <span class="title">String</span>) -&gt; （<span class="title">firstname</span>: <span class="title">String</span>, <span class="title">lastname</span>: <span class="title">String</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> fullnameInPieces = fullname.componentsSeparatedByString（<span class="string">" "</span>）</div><div class="line">    <span class="keyword">return</span> （fullnameInPieces[<span class="number">0</span>], fullnameInPieces[<span class="number">1</span>]）</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img src="http://www.appcoda.com/wp-content/uploads/2016/05/t52_10_keywords5.png" alt="全关键字"></p>
<h3 id="Jazzy-自动产生代码文档"><a href="#Jazzy-自动产生代码文档" class="headerlink" title="Jazzy 自动产生代码文档"></a>Jazzy 自动产生代码文档</h3><blockquote>
<p><a href="https://github.com/realm/jazzy" target="_blank" rel="external">Jazzy</a> 是一款可以为 Swift 和 Objective-C 代码产生具有 Apple 风格的代码文档工具。</p>
<h4 id="效果如下"><a href="#效果如下" class="headerlink" title="效果如下"></a>效果如下</h4><p><img src="http://www.appcoda.com/wp-content/uploads/2016/05/t52_15_jazzy_results.png" alt="jazzy 效果"></p>
</blockquote>
<h5 id="下面以Alamofire为例子："><a href="#下面以Alamofire为例子：" class="headerlink" title="下面以Alamofire为例子："></a>下面以<code>Alamofire</code>为例子：</h5><blockquote>
<p>jazzy –help 查看帮助</p>
<ul>
<li>cd Alamofire 的项目path</li>
<li>jazzy –output /Users/xcodeyang/Desktop/jazzy_document </li>
</ul>
</blockquote>
<p><strong><a href="http://swift.gg/2016/06/15/swift-markdown/" target="_blank" rel="external">参考博客地址</a></strong></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/document/">document</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动组周技术分享/">移动组周技术分享</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-2016-05-06" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/05/06/2016-05-06/" class="article-date">
  	<time datetime="2016-05-06T10:30:00.000Z" itemprop="datePublished">2016-05-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/06/2016-05-06/">枚举的特殊用法</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="枚举的特殊用法"><a href="#枚举的特殊用法" class="headerlink" title="枚举的特殊用法"></a>枚举的特殊用法</h2><blockquote>
<p>源于项目中的应用太广了，但是对swift的很多简单特性不熟。之前那个动画的<code>阶段</code>使用到enum有遇到困难暂时绕开它了</p>
</blockquote>
<p><code>当时的目标就是外部直接赋值操作</code></p>
<h3 id="如下动画的enum示例："><a href="#如下动画的enum示例：" class="headerlink" title="如下动画的enum示例："></a>如下动画的enum示例：</h3><blockquote>
<p>为了省事，目前直接使用死的文案放在这里</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">AnimationPeriod</span>: <span class="title">UInt</span> </span>&#123;</div><div class="line">    <span class="comment">// 动画执行的五个阶段</span></div><div class="line">    <span class="keyword">case</span> <span class="type">Start</span>,<span class="type">First</span>,<span class="type">Second</span>,<span class="type">Third</span>,<span class="type">End</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">description</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</div><div class="line">        <span class="keyword">case</span> .<span class="type">Start</span>, .<span class="type">First</span>:    <span class="keyword">return</span> <span class="string">"正在提取学校最新\n录取条件"</span></div><div class="line">        <span class="keyword">case</span> .<span class="type">Second</span>:           <span class="keyword">return</span> <span class="string">"正在与学校进行匹配"</span></div><div class="line">        <span class="keyword">case</span> .<span class="type">Third</span>, .<span class="type">End</span>:      <span class="keyword">return</span> <span class="string">"正在根据匹配结果\n生成选校方案"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">duration</span><span class="params">()</span></span> -&gt; <span class="type">NSTimeInterval</span> &#123;</div><div class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</div><div class="line">        <span class="keyword">case</span> .<span class="type">Start</span>:    <span class="keyword">return</span> <span class="number">0.8</span></div><div class="line">        <span class="keyword">case</span> .<span class="type">First</span>:    <span class="keyword">return</span> <span class="number">1</span></div><div class="line">        <span class="keyword">case</span> .<span class="type">Second</span>:   <span class="keyword">return</span> <span class="number">2</span></div><div class="line">        <span class="keyword">case</span> .<span class="type">Third</span>:    <span class="keyword">return</span> <span class="number">0.5</span></div><div class="line">        <span class="keyword">case</span> .<span class="type">End</span>:      <span class="keyword">return</span> <span class="number">0.25</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AnimationPeriod</span> </span>&#123;</div><div class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">next</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</div><div class="line">        <span class="keyword">case</span> .<span class="type">Start</span>:    <span class="keyword">self</span> = .<span class="type">First</span></div><div class="line">        <span class="keyword">case</span> .<span class="type">First</span>:    <span class="keyword">self</span> = .<span class="type">Second</span></div><div class="line">        <span class="keyword">case</span> .<span class="type">Second</span>:   <span class="keyword">self</span> = .<span class="type">Third</span></div><div class="line">        <span class="keyword">case</span> .<span class="type">Third</span>:    <span class="keyword">self</span> = .<span class="type">End</span></div><div class="line">        <span class="keyword">default</span>:        <span class="keyword">self</span> = .<span class="type">End</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="下面我们看看一些枚举的使用"><a href="#下面我们看看一些枚举的使用" class="headerlink" title="下面我们看看一些枚举的使用"></a>下面我们看看一些枚举的使用</h3><p>携带<code>参数</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">FamilyType</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">case</span> <span class="type">Father</span>(age: <span class="type">Int</span>)</div><div class="line">    <span class="keyword">case</span> <span class="type">Mother</span>(age: <span class="type">Int</span>)</div><div class="line">    <span class="keyword">case</span> <span class="type">Sister</span>(age: <span class="type">Int</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">gift</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">switch</span>(<span class="keyword">self</span>) &#123;</div><div class="line">        <span class="keyword">case</span> .<span class="type">Sister</span>(<span class="keyword">let</span> age):</div><div class="line">            <span class="keyword">if</span> age &gt; <span class="number">15</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="string">"iphone"</span></div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="string">"toy"</span></div><div class="line">            &#125;</div><div class="line">        <span class="keyword">case</span> .<span class="type">Mother</span>(<span class="keyword">let</span> age) <span class="keyword">where</span> age &lt; <span class="number">40</span>:</div><div class="line">            <span class="keyword">return</span> <span class="string">"cloth"</span></div><div class="line">        <span class="keyword">default</span>:</div><div class="line">            <span class="keyword">return</span> <span class="string">"book"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> someone = <span class="type">FamilyType</span>.<span class="type">Sister</span>(age: <span class="number">11</span>)</div><div class="line"><span class="keyword">let</span> somebody = <span class="type">FamilyType</span>.<span class="type">Mother</span>(age: <span class="number">40</span>)</div><div class="line"><span class="comment">// swift的枚举技巧</span></div><div class="line"><span class="keyword">let</span> someoneGift = someone.gift()     <span class="comment">// print toy</span></div><div class="line"><span class="keyword">let</span> somebodyGift = somebody.gift()	 <span class="comment">// book</span></div></pre></td></tr></table></figure>
<p>####那我们要取值的有</p>
<ul>
<li>方法一</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">switch</span> someone &#123;</div><div class="line"><span class="keyword">case</span> .<span class="type">Father</span>(<span class="keyword">let</span> age):</div><div class="line">    age</div><div class="line"><span class="keyword">case</span> .<span class="type">Sister</span>(<span class="keyword">let</span> age):</div><div class="line">    age</div><div class="line"><span class="keyword">default</span>:()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>方法二</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> <span class="keyword">case</span> .<span class="type">Sister</span>(<span class="keyword">let</span> age) = someone &#123;</div><div class="line">    age</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="枚举的嵌套"><a href="#枚举的嵌套" class="headerlink" title="枚举的嵌套"></a>枚举的嵌套</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Colleague</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Weight</span>: <span class="title">Int</span> </span>&#123;</div><div class="line">        <span class="keyword">case</span> <span class="type">Light</span></div><div class="line">        <span class="keyword">case</span> <span class="type">Mid</span></div><div class="line">        <span class="keyword">case</span> <span class="type">Heavy</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">case</span> iOS(weight: <span class="type">Weight</span>)</div><div class="line">    <span class="keyword">case</span> <span class="type">Android</span>(weight: <span class="type">Weight</span>)</div><div class="line">    <span class="keyword">case</span> <span class="type">HTML</span>(weight: <span class="type">Weight</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> woodenHelmet = <span class="type">Colleague</span>.iOS(weight: .<span class="type">Mid</span>)</div></pre></td></tr></table></figure>
<h3 id="枚举的成员变量"><a href="#枚举的成员变量" class="headerlink" title="枚举的成员变量"></a>枚举的成员变量</h3><p>之前就一直想要使用枚举做到外部动态对枚举赋值储存操作，<br>那成员变量用法如下</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 根据自身赋值</span></div><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Device</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> iPad, iPhone</div><div class="line">    <span class="keyword">var</span> year: <span class="type">Int</span> &#123;</div><div class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</div><div class="line">        <span class="keyword">case</span> iPhone: <span class="keyword">return</span> <span class="number">2007</span></div><div class="line">        <span class="keyword">case</span> iPad: <span class="keyword">return</span> <span class="number">2010</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// set get 方法对于枚举的成员变量是无效的，允许get调用但set不可执行</span></div><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Book</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">Story</span>, <span class="type">News</span></div><div class="line">    <span class="keyword">var</span> year: <span class="type">Int</span> &#123;</div><div class="line">        <span class="keyword">set</span>&#123;</div><div class="line">            year = newValue</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">get</span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">self</span>.year</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> myIpad = <span class="type">Device</span>.iPad</div><div class="line">myIpad.year</div><div class="line"></div><div class="line"><span class="keyword">var</span> storyBook = <span class="type">Book</span>.<span class="type">Story</span></div><div class="line"><span class="comment">//storyBook.year = 2010	 // set 方法此处报错</span></div><div class="line"><span class="comment">//storyBook.year			 // get 无效</span></div></pre></td></tr></table></figure>
<h3 id="初始化，感觉然并软"><a href="#初始化，感觉然并软" class="headerlink" title="初始化，感觉然并软"></a>初始化，感觉然并软</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">AppleDevice</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> iMac(price:<span class="type">Int</span>)</div><div class="line">    <span class="keyword">case</span> iPod(price:<span class="type">Int</span>)</div><div class="line">    <span class="keyword">case</span> iPhone(price:<span class="type">Int</span>)</div><div class="line">    <span class="keyword">init</span> (costMoney: <span class="type">Int</span>) &#123;</div><div class="line">        <span class="keyword">if</span> costMoney &gt; <span class="number">10000</span> &#123;</div><div class="line">            <span class="keyword">self</span> = .iMac(price: costMoney)</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> costMoney &gt; <span class="number">2500</span> &#123;</div><div class="line">            <span class="keyword">self</span> = .iPhone(price: costMoney)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">self</span> = .iPod(price: costMoney)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> myDevice = <span class="type">AppleDevice</span>(costMoney: <span class="number">6000</span>)</div></pre></td></tr></table></figure>
<h3 id="元组的使用"><a href="#元组的使用" class="headerlink" title="元组的使用"></a>元组的使用</h3><p>多个参数的介入时，可以使用元组,此处常规使用报错暂时无法解决，<br>使用func函数赋值倒是没有出错。why？？</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">HumanHabit</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">Reading</span></div><div class="line">    <span class="keyword">case</span> <span class="type">PlayGame</span></div><div class="line">    <span class="keyword">case</span> <span class="type">Traveling</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">typealias</span> <span class="type">HumanInfo</span> = (age: <span class="type">Int</span>, name: <span class="type">String</span>, habit: <span class="type">HumanHabit</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">selectRAM</span><span class="params">(humanInfo: HumanInfo)</span></span> -&gt; <span class="type">HumanInfo</span> &#123;<span class="keyword">return</span> (age: <span class="number">32</span>, name: humanInfo.name, habit: humanInfo.habit)&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">selectCPU</span><span class="params">(humanInfo: HumanInfo)</span></span> -&gt; <span class="type">HumanInfo</span> &#123;<span class="keyword">return</span> (age: humanInfo.age, name: <span class="string">"3.2GHZ"</span>, habit: humanInfo.habit)&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">selectGPU</span><span class="params">(humanInfo: HumanInfo)</span></span> -&gt; <span class="type">HumanInfo</span> &#123;<span class="keyword">return</span> (age: humanInfo.age, name: <span class="string">"3.2GHZ"</span>, habit: .<span class="type">Reading</span>)&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Desktop</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">Cube</span>(<span class="type">HumanInfo</span>)</div><div class="line">    <span class="keyword">case</span> <span class="type">Tower</span>(<span class="type">HumanInfo</span>)</div><div class="line">    <span class="keyword">case</span> <span class="type">Rack</span>(<span class="type">HumanInfo</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> aTower = <span class="type">Desktop</span>.<span class="type">Tower</span>(selectGPU(selectCPU(selectRAM((<span class="number">0</span>, <span class="string">""</span>, .<span class="type">Traveling</span>) <span class="keyword">as</span> <span class="type">HumanInfo</span>))))</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动组周技术分享/">移动组周技术分享</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-2016-04-22" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/22/2016-04-22/" class="article-date">
  	<time datetime="2016-04-22T10:30:00.000Z" itemprop="datePublished">2016-04-22</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/22/2016-04-22/">Swift 的 Playground 学习</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Swift-的-Playground-学习"><a href="#Swift-的-Playground-学习" class="headerlink" title="Swift 的 Playground 学习"></a>Swift 的 Playground 学习</h2><blockquote>
<p>我们一开始知道 <strong><em>Playground</em></strong>，也知道然后查看一些变量及变量的历史记录。偶尔还知道可以做视图甚至动画展示但是，现在，你特么看到的是 <strong><em>MarkDown</em></strong> 语法，有没有。</p>
</blockquote>
<h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><ul>
<li><a href="http://nshipster.cn/xcplayground/" target="_blank" rel="external">XCPlayground介绍&amp;实践</a></li>
<li><a href="https://developer.apple.com/library/mac/documentation/Miscellaneous/Reference/XCPlaygroundModuleRef/XCPlayground.html" target="_blank" rel="external">XCPlayground苹果官网文档</a></li>
</ul>
<h3 id="使用优势"><a href="#使用优势" class="headerlink" title="使用优势"></a>使用优势</h3><ul>
<li>快速学习swift</li>
<li>快速测试代码效果</li>
<li>验证API</li>
<li>富文本注释</li>
</ul>
<p><code>如下所有案例使用Xcode7下加载playground文件，可预览效果</code><br><a href="https://github.com/51offer/51offer.github.com/tree/blog/share_files/xcodeyang52.playground" target="_blank" rel="external">文件下载链接</a></p>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><blockquote>
<p>至上而下执行，显示变量的当前值及历史记录的变化。</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"杨志"</span></div><div class="line">name += <span class="string">"平"</span></div><div class="line"><span class="comment">// playground下预览</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> graph = <span class="number">0.0</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>...<span class="number">100</span> &#123;</div><div class="line">    graph = sin(<span class="type">Double</span>(i)/<span class="number">10.0</span>)</div><div class="line">    <span class="comment">// playground下预览</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="UI视图"><a href="#UI视图" class="headerlink" title="UI视图"></a>UI视图</h3><blockquote>
<p>简单显示UI的基础元素</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> redView = <span class="type">UIView</span>(frame:<span class="type">CGRectMake</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">100</span>,<span class="number">100</span>))</div><div class="line">redView.backgroundColor = <span class="type">UIColor</span>.redColor()</div><div class="line">redView.layer.cornerRadius = <span class="number">20</span></div><div class="line">redView.layer.borderWidth = <span class="number">3</span></div><div class="line">redView.layer.borderColor = <span class="type">UIColor</span>.whiteColor().<span class="type">CGColor</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> circle = <span class="type">UIView</span>(frame:<span class="type">CGRectMake</span>(<span class="number">25</span>,<span class="number">25</span>,<span class="number">50</span>,<span class="number">50</span>))</div><div class="line">circle.backgroundColor = <span class="type">UIColor</span>.yellowColor()</div><div class="line">circle.layer.cornerRadius = <span class="number">80</span></div><div class="line">redView.addSubview(circle)</div><div class="line"><span class="comment">// playground下预览</span></div></pre></td></tr></table></figure>
<h3 id="重头戏"><a href="#重头戏" class="headerlink" title="重头戏"></a>重头戏</h3><h4 id="动画展示-amp-网络请求"><a href="#动画展示-amp-网络请求" class="headerlink" title="动画展示 &amp; 网络请求"></a>动画展示 &amp; 网络请求</h4><blockquote>
<p>这里需要对 XCPlayground 有一点了解，好像还对SpriteKit做了支持<a href="http://letvar.com/blog/2014/06/swift-and-playgrounds-learn-to-program-in-a-fun-way-2/" target="_blank" rel="external">文章连接</a></p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 这个库需要import</span></div><div class="line"><span class="keyword">import</span> XCPlayground</div><div class="line"></div><div class="line"><span class="keyword">let</span> containerView = <span class="type">UIView</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">320</span>, height: <span class="number">480</span>))</div><div class="line">containerView.backgroundColor = <span class="type">UIColor</span>.yellowColor()</div><div class="line"><span class="type">XCPlaygroundPage</span>.currentPage.liveView = containerView</div><div class="line"></div><div class="line"><span class="keyword">let</span> view = <span class="type">UIView</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">100</span>, height: <span class="number">100</span>))</div><div class="line">view.center = <span class="type">CGPoint</span>(x: containerView.center.x, y: containerView.center.y-<span class="number">100</span>)</div><div class="line">view.backgroundColor = <span class="type">UIColor</span>.redColor()</div><div class="line">containerView.addSubview(view)</div><div class="line"></div><div class="line"><span class="comment">// playground下预览</span></div><div class="line"><span class="type">UIView</span>.animateWithDuration(<span class="number">3</span>, delay: <span class="number">0</span>, usingSpringWithDamping: <span class="number">0.1</span>, initialSpringVelocity: <span class="number">6</span>, options: <span class="type">UIViewAnimationOptions</span>.<span class="type">CurveEaseInOut</span>, animations: &#123;</div><div class="line">        view.center.y += <span class="number">100</span></div><div class="line">    &#125;, completion:&#123; (animation: <span class="type">Bool</span>) <span class="keyword">in</span></div><div class="line">        view.center.y -= <span class="number">100</span></div><div class="line">    &#125;</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// 异步操作：网络在家图片</span></div><div class="line"><span class="comment">// 旧接口：XCPSetExecutionShouldContinueIndefinitely(true)</span></div><div class="line"><span class="type">XCPlaygroundPage</span>.currentPage.needsIndefiniteExecution = <span class="literal">true</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> url = <span class="type">NSURL</span>(string: <span class="string">"https://avatars1.githubusercontent.com/u/5317671?v=3&amp;s=460"</span>)!</div><div class="line"><span class="keyword">let</span> task = <span class="type">NSURLSession</span>.sharedSession().dataTaskWithURL(url) &#123;</div><div class="line">    data, <span class="number">_</span>, <span class="number">_</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">let</span> image = <span class="type">UIImage</span>(data: data!)</div><div class="line">    <span class="comment">// playground下预览</span></div><div class="line">&#125;</div><div class="line">task.resume()</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 快速检查API接口</span></div><div class="line"><span class="keyword">let</span> url2 = <span class="type">NSURL</span>(string: <span class="string">"http://www.test.51offer.com/mobile/abroad/query_school_by_name?name=%E4%B8%80"</span>)!</div><div class="line"><span class="keyword">let</span> task2 = <span class="type">NSURLSession</span>.sharedSession().dataTaskWithURL(url2) &#123;</div><div class="line">    data, <span class="number">_</span>, <span class="number">_</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">let</span> str = <span class="type">String</span>(<span class="type">NSString</span>(data: data!, encoding: <span class="type">NSUTF8StringEncoding</span>))</div><div class="line">    <span class="comment">// playground下预览</span></div><div class="line">&#125;</div><div class="line">task2.resume()</div></pre></td></tr></table></figure>
<h3 id="结构介绍"><a href="#结构介绍" class="headerlink" title="结构介绍"></a>结构介绍</h3><ul>
<li><p>sources</p>
<blockquote>
<p>我们直接在 Playground 上面写代码，然后编译器会实时编译我们代码，并将结果显示出来。但是效率很低，source的作用就可以发挥出来</p>
</blockquote>
</li>
<li><p>resources</p>
<blockquote>
<p>可以作为sandbox使用</p>
</blockquote>
</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 直接使用PicButton 这个class.</span></div><div class="line"><span class="comment">// 注意点：PicButton的类及初始化方法必须是public的</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> btn = <span class="type">PicButton</span>(frame: <span class="type">CGRectMake</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">200</span>,<span class="number">100</span>))</div><div class="line"><span class="comment">// playground下预览</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 如上述：在resources中放入jpg图片，加载本地资源</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> <span class="keyword">let</span> path = <span class="type">NSBundle</span>.mainBundle().pathForResource(<span class="string">"swift-playground"</span>, ofType: <span class="string">"jpg"</span>) &#123;</div><div class="line">    <span class="keyword">let</span> image = <span class="type">UIImage</span>(contentsOfFile:path)</div><div class="line">    <span class="keyword">let</span> imageView = <span class="type">UIImageView</span>(image: image)</div><div class="line">        <span class="comment">// playground下预览</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Playground/">Playground</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动组周技术分享/">移动组周技术分享</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-2016-04-08" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/08/2016-04-08/" class="article-date">
  	<time datetime="2016-04-08T10:30:00.000Z" itemprop="datePublished">2016-04-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/08/2016-04-08/">快速集成TouchID</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="快速集成TouchID"><a href="#快速集成TouchID" class="headerlink" title="快速集成TouchID"></a>快速集成TouchID</h2><blockquote>
<p>iPhone 5s，iOS 8，iOS7时未开放</p>
<p>依赖 LocalAuthentication.framework</p>
</blockquote>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 判断设备支持状态</span></div><div class="line">LAContext *context = [[LAContext alloc] init];</div><div class="line">[context canEvaluatePolicy:LAPolicyDeviceOwnerAuthenticationWithBiometrics error:<span class="literal">nil</span>];</div><div class="line"></div><div class="line"><span class="comment">// 如果可以</span></div><div class="line">[context evaluatePolicy:LAPolicyDeviceOwnerAuthenticationWithBiometrics localizedReason:<span class="string">@"reason"</span> reply:^(<span class="built_in">BOOL</span> success, <span class="built_in">NSError</span> *error) &#123;</div><div class="line">            <span class="keyword">if</span> (success) &#123;</div><div class="line">                <span class="comment">//验证成功，主线程处理UI</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span></div><div class="line">            &#123;</div><div class="line">	            <span class="comment">// 重点：错误处理，分为多种错误</span></div><div class="line">	            <span class="comment">// 有验证失败、取消、手动输入密码等等相对应的逻辑处理</span></div><div class="line">	            <span class="comment">// 详见demo</span></div><div class="line">	        &#125;</div><div class="line">        &#125;];</div></pre></td></tr></table></figure>
<p><strong>错误类型</strong></p>
<ul>
<li>LAErrorAuthenticationFailed</li>
<li>LAErrorUserCancel</li>
<li>LAErrorUserFallback</li>
<li>LAErrorSystemCancel</li>
<li>LAErrorPasscodeNotSet  </li>
<li>LAErrorTouchIDNotAvailable</li>
<li>LAErrorTouchIDNotEnrolled </li>
<li>LAErrorTouchIDLockout   NS_ENUM_AVAILABLE(10_11, 9_0)</li>
<li>LAErrorAppCancel        NS_ENUM_AVAILABLE(10_11, 9_0) </li>
<li>LAErrorInvalidContext   NS_ENUM_AVAILABLE(10_11, 9_0)</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TouchID/">TouchID</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动组周技术分享/">移动组周技术分享</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-2016-03-11" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/11/2016-03-11/" class="article-date">
  	<time datetime="2016-03-11T10:30:00.000Z" itemprop="datePublished">2016-03-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/11/2016-03-11/">高阶函数及参数的省略</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="常见定义函数"><a href="#常见定义函数" class="headerlink" title="常见定义函数"></a>常见定义函数</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> normalFunc = &#123;</div><div class="line">    () -&gt; <span class="type">Int</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">return</span> <span class="number">10086</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> normalResult = normalFunc()</div><div class="line"><span class="comment">// normalResult = 10086</span></div></pre></td></tr></table></figure>
<p>###函数参数的『省略』<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 以数组排序函数为例：</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> numberArr = [<span class="number">1</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">5</span>]</div><div class="line"></div><div class="line"><span class="keyword">let</span> res1 = numberArr.<span class="built_in">sort</span>()</div><div class="line"></div><div class="line"><span class="keyword">let</span> res2 = numberArr.<span class="built_in">sort</span> &#123;</div><div class="line">    (num1: <span class="type">Int</span>, num2: <span class="type">Int</span>) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">return</span> num1&gt;num2</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> res3 = numberArr.<span class="built_in">sort</span> &#123;</div><div class="line">    (num1: <span class="type">Int</span>, num2: <span class="type">Int</span>) <span class="keyword">in</span></div><div class="line">    <span class="keyword">return</span> num1&gt;num2</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> res4 = numberArr.<span class="built_in">sort</span> &#123;</div><div class="line">    (num1, num2) <span class="keyword">in</span></div><div class="line">    <span class="keyword">return</span> num1&gt;num2</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> res5 = numberArr.<span class="built_in">sort</span> &#123;</div><div class="line">    <span class="keyword">return</span> $<span class="number">0</span> &gt; $<span class="number">1</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> res6 = numberArr.<span class="built_in">sort</span> &#123;</div><div class="line">    $<span class="number">0</span> &gt; $<span class="number">1</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> res7 = numberArr.<span class="built_in">sort</span>(&gt;)</div></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>变化过程</strong><br>{ (num1: Int, num2: Int) -&gt; Bool in return num1&gt;num2 }<br>{ (num1: Int, num2: Int) in return num1&gt;num2 }<br>{ (num1, num2) in return num1&gt;num2 }<br>{ return $0 &gt; $1 }<br>{ $0 &gt; $1 }</p>
</blockquote>
<h3 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h3><h4 id="案例一"><a href="#案例一" class="headerlink" title="案例一"></a>案例一</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">square</span><span class="params">(a:Float)</span></span> -&gt; <span class="type">Float</span> &#123;</div><div class="line">    <span class="keyword">return</span> a * a</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">cube</span><span class="params">(a:Float)</span></span> -&gt; <span class="type">Float</span> &#123;</div><div class="line">    <span class="keyword">return</span> a * a * a</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">averageSumOfSquares</span><span class="params">(a:Float,b:Float)</span></span> -&gt; <span class="type">Float</span> &#123;</div><div class="line">    <span class="keyword">return</span> (square(a) + square(b)) / <span class="number">2.0</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">averageSumOfCubes</span><span class="params">(a:Float,b:Float)</span></span> -&gt; <span class="type">Float</span> &#123;</div><div class="line">    <span class="keyword">return</span> (cube(a) + cube(b)) / <span class="number">2.0</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 像Swift的Currying（柯里化），可以灵活调配使用</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">averageOfFunction</span><span class="params">(a a:Float,b:Float,f:<span class="params">(Float -&gt; Float)</span></span></span>) -&gt; <span class="type">Float</span> &#123;</div><div class="line">    <span class="keyword">return</span> (f(a) + f(b)) / <span class="number">2</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> squareResult1 = averageOfFunction(a: <span class="number">2</span>, b: <span class="number">4</span>, f: square)</div><div class="line"></div><div class="line"><span class="keyword">let</span> squareResult2 = averageOfFunction(a: <span class="number">2</span>, b: <span class="number">4</span>, f: &#123;</div><div class="line">                                                        (a: <span class="type">Float</span>) -&gt; <span class="type">Float</span> <span class="keyword">in</span></div><div class="line">                                                            <span class="keyword">return</span> a * a</div><div class="line">                                                     &#125;)</div><div class="line"></div><div class="line"><span class="comment">//&#123;(x: Float) -&gt; Float in return x * x&#125;</span></div><div class="line"><span class="comment">//&#123;x in return x * x&#125;</span></div><div class="line"><span class="comment">//&#123;x in x * x&#125;</span></div><div class="line"><span class="comment">//&#123;$0 * $0&#125;</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> squareResult3 = averageOfFunction(a: <span class="number">2</span>, b: <span class="number">4</span>, f: &#123;$<span class="number">0</span> * $<span class="number">0</span>&#125;)</div></pre></td></tr></table></figure>
<h4 id="案例二"><a href="#案例二" class="headerlink" title="案例二"></a>案例二</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 正统高阶函数样式</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum1</span><span class="params">(value: Int)</span></span> -&gt; (<span class="type">Int</span> -&gt; <span class="type">Int</span>) &#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">adder</span><span class="params">(otherValue: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">        <span class="keyword">return</span> otherValue + value</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> adder</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 省略后</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum2</span><span class="params">(value: Int)</span></span> -&gt; (<span class="type">Int</span> -&gt; <span class="type">Int</span>) &#123;</div><div class="line">    <span class="keyword">return</span> &#123; $<span class="number">0</span> + value &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> result1 = sum1(<span class="number">2</span>)(<span class="number">3</span>)</div><div class="line"><span class="keyword">let</span> result2 = sum2(<span class="number">5</span>)(<span class="number">3</span>)</div><div class="line"></div><div class="line"><span class="comment">// 改造函数完毕</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">funcMathMethod1</span><span class="params">(first: Int -&gt; Int, <span class="number">_</span><span class="comment">/*起到变量匿名作用*/</span> second: Int -&gt; Int)</span></span> -&gt; <span class="type">Int</span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123; second(first($<span class="number">0</span>)) &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> f1 = funcMathMethod1(&#123;$<span class="number">0</span> + <span class="number">2</span>&#125;, &#123;$<span class="number">0</span> / <span class="number">3</span>&#125;)</div><div class="line">f1(<span class="number">7</span>)</div><div class="line"></div><div class="line"><span class="keyword">let</span> f2 = funcMathMethod1(&#123;$<span class="number">0</span> * $<span class="number">0</span>&#125;, &#123;$<span class="number">0</span> / <span class="number">4</span>&#125;)</div><div class="line">f2(<span class="number">10</span>)</div><div class="line"></div><div class="line"><span class="comment">// Tip: 使用函数式编程，要是用得不好容易造成可读性很差，那优化如下</span></div><div class="line"><span class="keyword">typealias</span> <span class="type">MathFunc</span> = <span class="type">Int</span> -&gt; <span class="type">Int</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">funcMathMethod2</span><span class="params">(f: MathFunc, <span class="number">_</span> s: MathFunc)</span></span> -&gt; <span class="type">MathFunc</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123; s(f($<span class="number">0</span>)) &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> readability = funcMathMethod1(&#123;$<span class="number">0</span> + <span class="number">2</span>&#125;, &#123;$<span class="number">0</span> / <span class="number">3</span>&#125;)</div><div class="line">readability(<span class="number">7</span>)</div></pre></td></tr></table></figure>
<h4 id="swift原生常用的高阶函数"><a href="#swift原生常用的高阶函数" class="headerlink" title="swift原生常用的高阶函数"></a>swift原生常用的高阶函数</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// map</span></div><div class="line"><span class="keyword">var</span> numberArr = [<span class="number">1</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">5</span>]</div><div class="line"></div><div class="line"><span class="keyword">let</span> mapArray = numberArr.<span class="built_in">map</span> &#123; (num: <span class="type">Int</span>) -&gt; <span class="type">String</span> <span class="keyword">in</span></div><div class="line">     <span class="keyword">return</span> <span class="string">"第<span class="subst">\(num)</span>名"</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> mapArray2 = numberArr.<span class="built_in">map</span>(&#123;<span class="string">"第<span class="subst">\($<span class="number">0</span>)</span>名"</span>&#125;)</div><div class="line">mapArray2</div><div class="line"></div><div class="line"><span class="comment">// 可选型随意解包 str 可以为 nil</span></div><div class="line"><span class="keyword">let</span> str: <span class="type">String</span>? = <span class="string">"1234567890"</span></div><div class="line"><span class="keyword">let</span> mapStr = str.<span class="built_in">map</span>(&#123;<span class="string">"第<span class="subst">\($<span class="number">0</span>)</span>名"</span>&#125;)</div><div class="line">mapStr</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// filter</span></div><div class="line"><span class="keyword">let</span> filArr = numberArr.<span class="built_in">filter</span> &#123; (num: <span class="type">Int</span>) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">return</span> num &gt; <span class="number">4</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> filArr2 = numberArr.<span class="built_in">filter</span>(&#123; $<span class="number">0</span> &gt; <span class="number">4</span> &#125;)</div><div class="line">filArr2</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// reduce</span></div><div class="line"><span class="keyword">let</span> sum = numberArr.<span class="built_in">reduce</span>(<span class="number">0</span>) &#123; (presum:<span class="type">Int</span>, num:<span class="type">Int</span>) -&gt; <span class="type">Int</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">return</span> presum + num</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> sum2 = numberArr.<span class="built_in">reduce</span>(<span class="number">10</span>, combine: &#123;$<span class="number">0</span> + $<span class="number">1</span>&#125;)</div><div class="line">sum2</div><div class="line"><span class="keyword">let</span> sumToStr = numberArr.<span class="built_in">reduce</span>(<span class="string">""</span>) &#123; (str: <span class="type">String</span>, num: <span class="type">Int</span>) -&gt; <span class="type">String</span> <span class="keyword">in</span></div><div class="line">    str + <span class="type">String</span>(num)</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 求一个数组中偶数的平方和（一口气使用swift提供的三个高阶函数）</span></div><div class="line"><span class="comment">//[1,2,3,4,5,6,7] -&gt; [2,4,6] -&gt; 4+16+36 = 56</span></div><div class="line"><span class="keyword">let</span> result = numberArr.<span class="built_in">filter</span>(&#123;$<span class="number">0</span>%<span class="number">2</span>==<span class="number">0</span>&#125;).<span class="built_in">map</span>(&#123;$<span class="number">0</span>*$<span class="number">0</span>&#125;).<span class="built_in">reduce</span>(<span class="number">0</span>, combine: &#123;$<span class="number">0</span>+$<span class="number">1</span>&#125;)</div><div class="line">result <span class="comment">// result = 56</span></div></pre></td></tr></table></figure>
<h3 id="面试题1"><a href="#面试题1" class="headerlink" title="面试题1"></a>面试题1</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 面试题：用数组的 reduce 方法实现 map 的功能。</span></div><div class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>]</div><div class="line"><span class="comment">// map简易实现</span></div><div class="line"><span class="keyword">let</span> res = arr.<span class="built_in">map</span>(&#123;$<span class="number">0</span>*<span class="number">2</span>&#125;)</div><div class="line"></div><div class="line"><span class="comment">// Array.reduce(&lt;#T##initial: T##T#&gt;, combine: &lt;#T##(T, Int) throws -&gt; T#&gt;)</span></div><div class="line"><span class="comment">// 输出数据类型与初始化占位数据类型（initial）一致</span></div><div class="line"><span class="keyword">let</span> res2 = arr.<span class="built_in">reduce</span>([]) &#123;</div><div class="line">    (a: [<span class="type">Int</span>], element: <span class="type">Int</span>) -&gt; [<span class="type">Int</span>] <span class="keyword">in</span></div><div class="line">    <span class="keyword">var</span> t = <span class="type">Array</span>(a)</div><div class="line">    t.append(element * <span class="number">2</span>)</div><div class="line">    <span class="keyword">return</span> t</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="面试题1-1"><a href="#面试题1-1" class="headerlink" title="面试题1"></a>面试题1</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 面试题：用 reduce 方法一次求出数组中奇数的和、以及偶数乘积</span></div><div class="line"><span class="comment">// 使用元组，注意占位数据(0, 1)，第一联合数据a :(Int, Int)，函数输出数据(Int, Int) 三者类型一致</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> arr2 = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>]</div><div class="line"></div><div class="line"><span class="keyword">let</span> res3: (<span class="type">Int</span>, <span class="type">Int</span>) = arr2.<span class="built_in">reduce</span>((<span class="number">0</span>, <span class="number">1</span>)) &#123;</div><div class="line">    (a :(<span class="type">Int</span>, <span class="type">Int</span>), element: <span class="type">Int</span>) -&gt; (<span class="type">Int</span>, <span class="type">Int</span>) <span class="keyword">in</span></div><div class="line">    <span class="keyword">if</span> element % <span class="number">2</span> == <span class="number">0</span> &#123;</div><div class="line">        <span class="keyword">return</span> (a.<span class="number">0</span>, a.<span class="number">1</span> * element)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> (a.<span class="number">0</span> + element, a.<span class="number">1</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动组周技术分享/">移动组周技术分享</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-2016-02-26" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/26/2016-02-26/" class="article-date">
  	<time datetime="2016-02-26T10:30:00.000Z" itemprop="datePublished">2016-02-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/26/2016-02-26/">swift 的 guard &amp; defer</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="guard-使用"><a href="#guard-使用" class="headerlink" title="guard 使用"></a>guard 使用</h3><blockquote>
<p>守卫，和隐式解析搭配有奇效</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 原始方法 (强解包可能会出现问题)</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tranIntToString1</span><span class="params">(x: Int?)</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">    <span class="keyword">if</span> x == <span class="literal">nil</span> || x! &lt;= <span class="number">0</span> &#123;</div><div class="line">  	    <span class="comment">// 不符合值的要求时，写点代码</span></div><div class="line">        <span class="keyword">return</span> <span class="string">""</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 使用x</span></div><div class="line">    <span class="keyword">return</span> x!.description</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 改进</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tranIntToString2</span><span class="params">(x: Int?)</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> x = x <span class="keyword">where</span> x&gt;<span class="number">0</span> &#123;</div><div class="line">        <span class="keyword">return</span> x.description</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="string">""</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 保镖模式</span></div><div class="line"><span class="comment">// 和上面写法对比</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tranIntToString3</span><span class="params">(x: Int?)</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> x = x <span class="keyword">where</span> x &gt; <span class="number">0</span> <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">""</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 变量不符合条件判断时，执行下面代码</span></div><div class="line">    <span class="keyword">return</span> x.description</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 非可选型</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tranIntToString4</span><span class="params">(x: Int)</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">    <span class="keyword">guard</span> x &gt; <span class="number">0</span> <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">""</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> x.description</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 常常用于条件判断拦截</span></div><div class="line"><span class="keyword">var</span> view = <span class="type">UIView</span>(frame: <span class="type">CGRectMake</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">80</span>,<span class="number">80</span>))</div><div class="line">view.backgroundColor = <span class="type">UIColor</span>.redColor()</div><div class="line"></div><div class="line"><span class="type">UIView</span>.animateWithDuration(<span class="number">0.3</span>) &#123; [<span class="keyword">weak</span> view]() -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> view = view <span class="keyword">where</span> view.alpha&gt;<span class="number">0</span> <span class="keyword">else</span> &#123;<span class="keyword">return</span>&#125;</div><div class="line">    view.alpha = <span class="number">0</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="懒加载"><a href="#懒加载" class="headerlink" title="懒加载"></a>懒加载</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//1.分析 NSArray 是一个闭包的返回值，而这是一个没有参数的闭包 </span></div><div class="line"><span class="built_in">lazy</span> <span class="keyword">var</span> dataArray:<span class="type">NSArray</span> = &#123; [] &#125;() </div><div class="line"></div><div class="line"><span class="comment">//2.也可以写成这样 </span></div><div class="line"><span class="built_in">lazy</span> <span class="keyword">var</span> dataArray:<span class="type">NSArray</span> = &#123; <span class="keyword">return</span> <span class="type">NSArray</span>() &#125;()</div><div class="line"></div><div class="line"><span class="comment">//3.从plist文件加载 </span></div><div class="line"><span class="built_in">lazy</span> <span class="keyword">var</span> dataArray:<span class="type">Array</span>&lt;<span class="type">XWWine</span>&gt; = &#123;</div><div class="line">    <span class="keyword">let</span> winePath = <span class="type">NSBundle</span>.mainBundle().pathForResource(<span class="string">"wine.plist"</span>, ofType: <span class="literal">nil</span>)!</div><div class="line">    <span class="keyword">let</span> winesM = <span class="type">NSMutableArray</span>(contentsOfFile: winePath);</div><div class="line">    <span class="keyword">var</span> tmpArray:<span class="type">Array</span>&lt;<span class="type">XWWine</span>&gt;! = []</div><div class="line">    <span class="keyword">for</span> tmpWineDict <span class="keyword">in</span> winesM! &#123;</div><div class="line">        <span class="keyword">var</span> wine:<span class="type">XWWine</span> = <span class="type">XWWine</span>.wineWithDict(tmpWineDict <span class="keyword">as</span>! <span class="type">NSDictionary</span>)</div><div class="line">        tmpArray.append(wine)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//lazy闭包里就运行一次</span></div><div class="line">    <span class="keyword">return</span> tmpArray</div><div class="line">&#125;()</div></pre></td></tr></table></figure>
<blockquote>
<p>调用的时候再在家初始化方法（懒加载）</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">lazy</span> <span class="keyword">private</span> <span class="keyword">var</span> underlineView: <span class="type">UIView</span> = &#123;</div><div class="line">    <span class="keyword">let</span> view = <span class="type">UIView</span>(frame: .zero)</div><div class="line">    <span class="keyword">return</span> view</div><div class="line">&#125;()</div></pre></td></tr></table></figure>
<h3 id="defer-关键字"><a href="#defer-关键字" class="headerlink" title="defer 关键字"></a>defer 关键字</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">    defer 关键字</div><div class="line">*/</div><div class="line"><span class="keyword">postfix</span> <span class="function"><span class="keyword">func</span> ++<span class="params">(<span class="keyword">inout</span> x: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    <span class="keyword">defer</span> &#123;</div><div class="line">        x = x/<span class="number">2</span></div><div class="line">        <span class="keyword">defer</span> &#123;</div><div class="line">            x += <span class="number">100</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> x</div><div class="line">&#125;</div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//postfix func ++(inout x: Int) -&gt; Int &#123;</span></div><div class="line"><span class="comment">//    let current = x</span></div><div class="line"><span class="comment">//    x += 2</span></div><div class="line"><span class="comment">//    return current</span></div><div class="line"><span class="comment">//&#125;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">var</span> num = <span class="number">100</span></div><div class="line"><span class="keyword">let</span> num2 = num++</div><div class="line">num		<span class="comment">//150</span></div><div class="line">num2	<span class="comment">//100</span></div><div class="line"></div><div class="line"><span class="keyword">prefix</span> <span class="function"><span class="keyword">func</span> ++<span class="params">(<span class="keyword">inout</span> x:Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    x += <span class="number">2</span></div><div class="line">    <span class="keyword">return</span> x</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> number = <span class="number">100</span></div><div class="line"><span class="keyword">let</span> number2 = ++number</div><div class="line">number 		<span class="comment">// 102</span></div><div class="line">number2		<span class="comment">// 102</span></div></pre></td></tr></table></figure>
<h4 id="嵌套枚举使用-简直就是动态Model"><a href="#嵌套枚举使用-简直就是动态Model" class="headerlink" title="嵌套枚举使用(简直就是动态Model)"></a>嵌套枚举使用(简直就是动态Model)</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">MenuScrollingMode</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">ScrollEnabled</span></div><div class="line">    <span class="keyword">case</span> <span class="type">ScrollEnabledAndBouces</span></div><div class="line">    <span class="keyword">case</span> <span class="type">PagingEnabled</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">MenuItemWidthMode</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">Flexible</span></div><div class="line">    <span class="keyword">case</span> <span class="type">Fixed</span>(width: <span class="type">CGFloat</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">MenuDisplayMode</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">Standard</span>(widthMode: <span class="type">MenuItemWidthMode</span>, centerItem: <span class="type">Bool</span>, scrollingMode: <span class="type">MenuScrollingMode</span>)</div><div class="line">    <span class="keyword">case</span> <span class="type">SegmentedControl</span></div><div class="line">    <span class="keyword">case</span> <span class="type">Infinite</span>(widthMode: <span class="type">MenuItemWidthMode</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 初始化：用来携带信息很不错</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">var</span> menuDisplayMode = <span class="type">MenuDisplayMode</span>.<span class="type">Standard</span>(widthMode: <span class="type">PagingMenuOptions</span>.<span class="type">MenuItemWidthMode</span>.<span class="type">Fixed</span>(width: <span class="number">44</span>), centerItem: <span class="literal">false</span>, scrollingMode: <span class="type">PagingMenuOptions</span>.<span class="type">MenuScrollingMode</span>.<span class="type">PagingEnabled</span>)</div><div class="line"></div><div class="line"><span class="comment">// 实例</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">labelWidth</span><span class="params">(size size: CGSize, widthMode: PagingMenuOptions.MenuItemWidthMode)</span></span> -&gt; <span class="type">CGFloat</span> &#123;</div><div class="line"></div><div class="line">    <span class="keyword">switch</span> widthMode &#123;</div><div class="line">    <span class="keyword">case</span> .<span class="type">Flexible</span>: <span class="keyword">return</span> ceil(size.width)</div><div class="line">    <span class="keyword">case</span> <span class="keyword">let</span> .<span class="type">Fixed</span>(width): <span class="keyword">return</span> width</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/defer/">defer</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/guard/">guard</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/lazy/">lazy</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动组周技术分享/">移动组周技术分享</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-2015-12-25" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/25/2015-12-25/" class="article-date">
  	<time datetime="2015-12-25T10:30:00.000Z" itemprop="datePublished">2015-12-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/25/2015-12-25/">The Bash Shell 变量(初级)</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="The-Bash-Shell-变量-初级"><a href="#The-Bash-Shell-变量-初级" class="headerlink" title="The Bash Shell 变量(初级)"></a>The Bash Shell 变量(初级)</h2><p>@(Share)[shell]</p>
<p>[TOC]</p>
<p>###前言<br><code>我有一个想法，希望通过学习脚本来实现blog的自动创建及发布等操作，</code><br><code>zm推荐shell，pj建议js</code></p>
<h4 id="常见bash熟悉的特性："><a href="#常见bash熟悉的特性：" class="headerlink" title="常见bash熟悉的特性："></a>常见bash熟悉的特性：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#$：(关于本 shell 的 PID)</div><div class="line">#钱字号本身也是个变量喔！这个咚咚代表的是『目前这个 Shell 的线程代号』，亦即是所谓的 PID (Process ID)。 更多的程序观念，我们会在第四篇的时候提及。想要知道我们的 shell 的 PID ，就可以用：『 echo $$ 』即可！出现的数字就是你的 PID 号码。</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $$</div><div class="line">10337</div><div class="line">#?：(关于上个运行命令的回传值)</div><div class="line">#问号也是一个特殊的变量？在 bash 里面这个变量可重要的很！ 这个变量是：『上一个运行的命令所回传的值』， 上面这句话的重点是『上一个命令』与『回传值』两个地方。当我们运行某些命令时， 这些命令都会回传一个运行后的代码。一般来说，如果成功的运行该命令， 则会回传一个 0 值，如果运行过程发生错误，就会回传『错误代码』才对！一般就是以非为 0 的数值来取代。</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo$</div><div class="line">-bash: echo$: command not found</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $?</div><div class="line">127	# &lt;== error</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $?</div><div class="line">0	# &lt;== success</div></pre></td></tr></table></figure>
<ul>
<li>命令编修能力 (history)：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $HISTSIZE</div><div class="line">500</div></pre></td></tr></table></figure>
<ul>
<li>命令与文件补全功能： <blockquote>
<p> [tab] 按键的好处</p>
<ul>
<li>一下和两下的区别</li>
<li>命令与文件路径</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">XcodeYangdeMBP2:~ xcodeyang$ x</div><div class="line">xar              xcodebuild       xgettext5.18.pl  xmllint          xslt-config</div><div class="line">xargs            xcodeproj        xip              xpath            xsltproc</div><div class="line">xattr            xcrun            xjc              xpath5.16        xsubpp</div><div class="line">xattr-2.6        xed              xml2-config      xpath5.18        xsubpp5.16</div><div class="line">xattr-2.7        xgettext.pl      xml2man          xsanctl          xsubpp5.18</div><div class="line">xcode-select     xgettext5.16.pl  xmlcatalog       xscertadmin      xxd</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ x</div></pre></td></tr></table></figure>
<ul>
<li>命令别名配置功能： (alias)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">XcodeYangdeMBP2:~ xcodeyang$ alias xcodedaniel=&apos;ls&apos;</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ cd Documents/</div><div class="line">XcodeYangdeMBP2:Documents xcodeyang$ xcodedaniel</div><div class="line">GItHub		Welcome.itmz	bloodsugar	技术部分享</div><div class="line">XcodeYangdeMBP2:Documents xcodeyang$ ls</div><div class="line">GItHub		Welcome.itmz	bloodsugar	技术部分享</div><div class="line">XcodeYangdeMBP2:Documents xcodeyang$</div></pre></td></tr></table></figure>
<p>可变性与方便性</p>
<blockquote>
<p>举例：MAIL 变量不同用户设置<br>yzp -&gt;  /var/spool/mail/yzp<br>cy   -&gt;  /var/spool/mail/cy<br>pj   -&gt;  /var/spool/mail/pj<br>zm  -&gt;  /var/spool/mail/zm</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $USER</div><div class="line">xcodeyang</div></pre></td></tr></table></figure>
<p>###变量的取用与配置：echo, 变量配置守则, unset</p>
<p><code>变量的取用就如同上面的范例，利用 echo 就能够读出，只是需要在变量名称前面加上 $ ， 或者是以 ${变量} 的方式来取用都可以</code></p>
<p>####变量的配置守则</p>
<ul>
<li><p>变量与变量内容以一个等号『=』来连结，如下所示： </p>
<blockquote>
<p>『yname=zhipingyang』</p>
</blockquote>
</li>
<li><p>等号两边不能直接接空格符，如下所示为错误： </p>
<blockquote>
<p>『myname = zhipingyang』或『myname=zhiping yang』</p>
</blockquote>
</li>
<li><p>变量名称只能是英文字母与数字，但是开头字符不能是数字，如下为错误： </p>
<blockquote>
<p>『2myname=zhipingyang』</p>
</blockquote>
</li>
<li><p>变量内容若有空格符可使用双引号『”』或单引号『’』将变量内容结合起来，但<br>双引号内的特殊字符如 $ 等，可以保有原本的特性，如下所示：</p>
<blockquote>
<p>『var=”lang is $LANG”』则『echo $var』可得『lang is en_US』</p>
</blockquote>
</li>
<li><p>单引号内的特殊字符则仅为一般字符 (纯文本)，如下所示：</p>
<blockquote>
<p>『var=’lang is $LANG’』则『echo $var』可得『lang is $LANG』</p>
</blockquote>
</li>
<li><p>可用跳脱字符『 \ 』将特殊符号(如 [Enter], $, \, 空格符, ‘等)变成一般字符；</p>
<blockquote>
<p>XcodeYangdeMBP2:~ xcodeyang$ myname=hello\ world</p>
</blockquote>
</li>
<li><p>在一串命令中，还需要藉由其他的命令提供的信息，可以使用反单引号『<code>命令</code>』或 『$(命令)』。特别注意，那个 ` 是键盘上方的数字键 1 左边那个按键，而不是单引号！ 例如想要取得核心版本的配置：</p>
<blockquote>
<p>『version=$(uname -r)』再『echo $version』可得『2.6.18-128.el5』</p>
</blockquote>
</li>
<li><p>若该变量为扩增变量内容时，则可用 “$变量名称” 或 ${变量} 累加内容，如下所示：</p>
<blockquote>
<p>『PATH=”$PATH”:/home/bin』</p>
</blockquote>
</li>
<li><p>若该变量需要在其他子程序运行，则需要以 export 来使变量变成环境变量：</p>
<blockquote>
<p>『export PATH』</p>
</blockquote>
</li>
<li><p>取消变量的方法为使用 unset ：『unset 变量名称』例如取消 myname 的配置：</p>
<blockquote>
<p>『unset myname』</p>
</blockquote>
</li>
</ul>
<p>设置myname变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"># 例子一</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $myname</div><div class="line">#				&lt;==这里并没有任何数据～因为这个变量尚未被配置！是空的！</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ myname = Daniel</div><div class="line">-bash: myname: command not found</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ myname=Daniel</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $myname</div><div class="line">Daniel</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ bash</div><div class="line">bash-3.2$ echo $myname</div><div class="line">#				&lt;==这里并没有任何数据～因为这个变量是自定义变量（局部变量）</div><div class="line">bash-3.2$ exit</div><div class="line">exit</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ export myname	#修改成环境变量(全局变量)</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ bash</div><div class="line">bash-3.2$ echo $myname</div><div class="line">Daniel</div><div class="line">bash-3.2$ unset myname</div><div class="line">bash-3.2$ echo $myname</div><div class="line">bash-3.2$ exit</div><div class="line">exit</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $myname</div><div class="line">Daniel</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ </div><div class="line"># 例子二</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $HOME</div><div class="line">/Users/xcodeyang</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ HOME=$HOME/home/bin</div><div class="line">XcodeYangdeMBP2:xcodeyang xcodeyang$ echo $HOME</div><div class="line">/Users/xcodeyang/home/bin</div><div class="line"># myname=$mynameyes  </div><div class="line"># 如果没有双引号，name 的内容是 $nameyes 这个变量！</div><div class="line"># tip：配错使用control+c取消继续，下面是正确的</div><div class="line"># myname=&quot;$myname&quot;yes</div><div class="line"># myname=$&#123;myname&#125;yes	&lt;==以此例较佳！</div><div class="line"># 猜测一下，那个是对/错</div><div class="line">myname=&quot;myname&apos;s name&quot; </div><div class="line">myname=&apos;myname&apos;s name&apos; </div><div class="line">myname=myname\&apos;s\ name</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $name</div><div class="line">yzp</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ name=&quot;$name is daniel&quot;</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $name</div><div class="line">yzp is daniel</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ name=&apos;$name is daniel&apos;</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $name</div><div class="line">$name is daniel</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$</div></pre></td></tr></table></figure>
<h3 id="环境变量的功能：-env-与常见环境变量说明-set-export"><a href="#环境变量的功能：-env-与常见环境变量说明-set-export" class="headerlink" title="环境变量的功能： env 与常见环境变量说明, set, export"></a>环境变量的功能： env 与常见环境变量说明, set, export</h3><p><code>bash 可不只有环境变量喔，还有一些与 bash 操作接口有关的变量，以及用户自己定义的变量存在的. set 除了环境变量之外， 还会将其他在 bash 内的变量通通显示出来哩！信息太多</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">XcodeYangdeMBP2:~ xcodeyang$ newname=daniel</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ name=xcodeyang</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ export name</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ env #&lt;==看这里</div><div class="line">TERM_PROGRAM=Apple_Terminal #使用&#123;大写的字母&#125;来配置的变量一般为系统内定需要的变量</div><div class="line">SHELL=/bin/bash</div><div class="line">TERM=xterm-256color</div><div class="line">TMPDIR=/var/folders/1c/hw10tv792_92fz5cswgmzqmc0000gn/T/</div><div class="line">Apple_PubSub_Socket_Render=/private/tmp/com.apple.launchd.Zcy3n3bgYL/Render</div><div class="line">TERM_PROGRAM_VERSION=361.1</div><div class="line">TERM_SESSION_ID=A7EE49FA-7C48-49A4-BA91-8144FACFB146</div><div class="line">name=xcodeyang	#&lt;==看这里</div><div class="line">USER=xcodeyang</div><div class="line">SSH_AUTH_SOCK=/private/tmp/com.apple.launchd.Sey2Soe8fS/Listeners</div><div class="line">__CF_USER_TEXT_ENCODING=0x1F5:0x0:0x0</div><div class="line">PATH=/Users/xcodeyang/.rbenv/shims:/Users/xcodeyang/.rbenv/bin:/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/git/bin</div><div class="line">PWD=/Users/xcodeyang</div><div class="line">XPC_FLAGS=0x0</div><div class="line">RBENV_SHELL=bash</div><div class="line">XPC_SERVICE_NAME=0</div><div class="line">SHLVL=1</div><div class="line">HOME=/Users/xcodeyang</div><div class="line">LOGNAME=xcodeyang</div><div class="line">LC_CTYPE=UTF-8</div><div class="line">_=/usr/bin/env</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$</div></pre></td></tr></table></figure>
<p>###变量的有效范围<br>环境变量=全局变量<br>自定义变量=局部变量    </p>
<blockquote>
<p>为什么环境变量的数据可以被子程序所引用呢？这是因为内存配置的关系！理论上是这样的：</p>
<ul>
<li>当启动一个 shell，操作系统会分配一记忆区块给 shell 使用，此内存内之变量可让子程序取用</li>
<li>若在父程序利用 export 功能，可以让自定义变量的内容写到上述的记忆区块当中(环境变量)；</li>
<li>当加载另一个 shell 时 (亦即启动子程序，而离开原本的父程序了)，子 shell 可以将父 shell 的环境变量所在的记忆区块导入自己的环境变量区块当中。</li>
</ul>
</blockquote>
<p>###变量键盘读取、数组与宣告： read, declare, array</p>
<blockquote>
<p>我们上面提到的变量配置功能，都是由命令列直接配置的，那么，可不可以让用户能够经由键盘输入？ 什么意思呢？是否记得某些程序运行的过程当中，会等待使用者输入 “yes/no” 之类的信息啊？</p>
<p>####read</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $name</div><div class="line">zhipingyang</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ read name</div><div class="line">%^$$uhda asuh_uha!@#~	#关键是没有之前那样的语法格式限制</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $name</div><div class="line">%^$$uhda asuh_uha!@#~</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ </div><div class="line">#-p  ：后面可以接提示字符！</div><div class="line">#-t  ：后面可以接等待的『秒数！』这个比较有趣～不会一直等待使用者啦！</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ read -p &quot;Please keyin your age: &quot; -t 30 agenum</div><div class="line">Please keyin your age: 33</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $agenum</div><div class="line">33</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$</div></pre></td></tr></table></figure>
<h4 id="declare-typeset"><a href="#declare-typeset" class="headerlink" title="declare / typeset"></a>declare / typeset</h4><blockquote>
<p>declare 或 typeset 是一样的功能，就是在『宣告变量的类型』</p>
<p>-a  ：将后面名为 variable 的变量定义成为数组 (array) 类型<br>-i  ：将后面名为 variable 的变量定义成为整数数字 (integer) 类型<br>-x  ：用法与 export 一样，就是将后面的 variable 变成环境变量；<br>-r  ：将变量配置成为 readonly 类型，该变量不可被更改内容，也不能 unset</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">#示例1：</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ sum=10+20+30</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $sum</div><div class="line">10+20+30		#&lt;==默认类型是string</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ declare -i sum=10+20+30</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $sum</div><div class="line">60</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ declare -i sum=1/3</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo $sum</div><div class="line">0	# &lt;==bash 环境中的数值运算，默认最多仅能到达整数形态</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$</div><div class="line">#示例2</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ declare -ixr sum=20+30 #只读整型环境变量</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ bash</div><div class="line">bash-3.2$ echo $sum</div><div class="line">50	#子程序里依然可以访问</div><div class="line">bash-3.2$ exit</div><div class="line">exit</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ sum=30</div><div class="line">-bash: sum: readonly variable	#不可修改</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ </div><div class="line">#示例3: 建议直接以 $&#123;数组&#125; 的方式来读取</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ var[1]=$SHELL</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ var[2]=$sum</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ var[3]=&quot;helloworld&quot;</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$ echo &quot;$&#123;var[1]&#125;, $&#123;var[2]&#125;, $&#123;var[3]&#125;&quot;</div><div class="line">/bin/bash, 50, helloworld</div><div class="line">XcodeYangdeMBP2:~ xcodeyang$</div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javaScript/">javaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/phython/">phython</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/">shell</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/移动组周技术分享/">移动组周技术分享</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2018 ShirleyYoung
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>